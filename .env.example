# =============================================================================
# ENVIRONMENT CONFIGURATION
# =============================================================================
# This file provides default configuration for both local development and deployment.
#
# LOCAL DEVELOPMENT:
# - Copy this file to .env and customize for your local setup
# - Each git worktree should have its own .env file with unique ports
#
# DOCKER DEPLOYMENT:
# - This file is included in the Docker image (no secrets!)
# - Container startup automatically copies .env.example â†’ .env
# - Docker environment variables override values in .env
# - Only secrets need to be provided via docker-compose environment variables
# =============================================================================

# =============================================================================
# WORKTREE CONFIGURATION
# =============================================================================
# This template supports running multiple git worktrees in parallel.
# Each worktree should have its own .env file with unique ports.
#
# PORT ALLOCATION STRATEGY:
# - main worktree:    PORT_OFFSET=0   (ports 5000, 5001, 5173, 5432, 6379, 9000, 9001)
# - worktree-1:       PORT_OFFSET=100 (ports 5100, 5101, 5273, 5532, 6479, 9100, 9101)
# - worktree-2:       PORT_OFFSET=200 (ports 5200, 5201, 5373, 5632, 6579, 9200, 9201)
# - worktree-3:       PORT_OFFSET=300 (ports 5300, 5301, 5473, 5732, 6679, 9300, 9301)
#
# USAGE:
# 1. Copy this file to .env in your worktree
# 2. Set WORKTREE_ID to a unique identifier (e.g., branch name)
# 3. Set PORT_OFFSET to a unique value (0, 100, 200, etc.)
# 4. All ports will be calculated automatically
# =============================================================================

# Worktree identifier (use branch name or descriptive name)
WORKTREE_ID=main

# Port offset for this worktree (0 for main, 100/200/300 for others)
PORT_OFFSET=0

# =============================================================================
# DOCKER SERVICE PORTS (calculated from PORT_OFFSET)
# =============================================================================
# PostgreSQL external port (default: 5432 + offset)
POSTGRES_PORT=5432

# Redis external port (default: 6379 + offset)
REDIS_PORT=6379

# =============================================================================
# DOCKER SERVICE CREDENTIALS
# =============================================================================
# PostgreSQL database credentials
POSTGRES_USER=postgres
POSTGRES_PASSWORD=123456
POSTGRES_DB=ideaforge

# MinIO (S3-compatible storage) credentials
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=minioadmin

# =============================================================================
# APPLICATION PORTS (calculated from PORT_OFFSET)
# =============================================================================
# NestJS API port (default: 5000 + offset)
NEST_API_PORT=5000

# NestJS WebSocket port for Hocuspocus (default: 5001 + offset)
# IMPORTANT: Must match CLIENT_COLLAB_WS_URL port below
NEST_API_WS_PORT=5001

# Vite dev server port (default: 5173 + offset)
VITE_PORT=5173


# VS Code debug port for NestJS (optional, default: 9333)
DEBUG_PORT=9333

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
# PostgreSQL connection URL (port and database name use worktree-specific values)
DATABASE_URL=postgresql://postgres:123456@localhost:5432/ideaforge?schema=public

# Redis configuration
REDIS_HOST=localhost

# =============================================================================
# APPLICATION CONFIGURATION
# =============================================================================
NODE_ENV=development

# Session and JWT secrets (generate with: openssl rand -base64 32)
SESSION_SECRET=Kj9mP2$vR5nX8wL4tB7cF3hQ6y9dM
JWT_SECRET=Hy2Aq9mK$pL7vX4nR8tB3wE5jN6cF
JWT_EXPIRES_IN=14d
REFRESH_TOKEN_SECRET=Hy2Aq9mK$pL7vX4nR8tB3wE5jN6cF
REFRESH_TOKEN_EXPIRES_IN=30d

# Collaboration secret key
COLLAB_SECRET_KEY=your_collab_secret_key

# Email service
RESEND_API_KEY=your_resend_api_key
EMAIL_FROM=noreply@news.ideaforge.link

# Super admin email
SUPER_ADMIN_EMAIL=ideaforgetest@gmail.com

# Deduplication window for document update notifications (in seconds)
# Prevents spam by ensuring users receive at most 1 notification per document within this window
# Default: 21600 (6 hours), For testing: 5 seconds
NOTIFICATION_DEDUPLICATION_WINDOW_SECONDS=21600

# =============================================================================
# OAUTH CONFIGURATION (URLs use worktree-specific API port)
# =============================================================================
# Google OAuth (get credentials from https://console.cloud.google.com/apis/credentials)
GOOGLE_CLIENT_ID=your_id
GOOGLE_CLIENT_SECRET=your_secret_key
GOOGLE_CALLBACK_URL=http://localhost:5000/api/auth/google/callback

# GitHub OAuth
GITHUB_CLIENT_ID=Ov23lisil9vu3eHIYex2
GITHUB_CLIENT_SECRET=b79466a5dc3746c34713e0d544538cf7e16ddf5f
GITHUB_CALLBACK_URL=http://localhost:5000/api/auth/github/callback

# =============================================================================
# FILE STORAGE (OSS) CONFIGURATION
# =============================================================================
# MinIO ports
MINIO_PORT=9000
MINIO_CONSOLE_PORT=9001

# Storage provider: minio (default), cos (Tencent), oss (Aliyun), s3 (AWS)
OSS_PROVIDER=minio

# MinIO credentials (matches MINIO_ROOT_USER/PASSWORD)
OSS_SECRET_ID=minioadmin
OSS_SECRET_KEY=minioadmin
OSS_BUCKET=assets-idea-forge-dev
OSS_REGION=us-east-1

# OSS Endpoints
# Local development: Leave empty (auto-configured)
# Production: Set OSS_ENDPOINT to your assets subdomain
# See deployment docs for detailed configuration
OSS_ENDPOINT=
OSS_CDN_ENDPOINT=

# Production examples:
# MinIO behind Nginx:
#   OSS_ENDPOINT=https://assets.yourdomain.com
#   OSS_CDN_ENDPOINT=  # Leave empty
#
# Cloud providers:
#   OSS_PROVIDER=oss
#   OSS_ENDPOINT=https://oss-ap-southeast-1.aliyuncs.com
#   OSS_CDN_ENDPOINT=https://cdn.yourdomain.com  # Optional

# =============================================================================
# AI PROVIDERS
# =============================================================================
SILICON_FLOW_API_KEY_1=your_api_key
DEEPSEEK_API_KEY_1=your_deepseek_api_key

# =============================================================================
# SENTRY MONITORING (Optional)
# =============================================================================
# Runtime variables - provide via environment or leave empty to disable
# Code will check if these are empty and skip Sentry initialization if not configured

# Sentry auth tokens (optional - for source map uploads during build)
SENTRY_AUTH_TOKEN=
SENTRY_AUTH_TOKEN_REACT=

# Sentry DSN (optional - for error tracking at runtime)
SENTRY_DSN=

# =============================================================================
# CLIENT CONFIGURATION (injected to window.ENV)
# =============================================================================
# Client application URL (uses worktree-specific API port)
CLIENT_APP_URL=http://localhost:5000

# Client collaboration WebSocket URL (uses worktree-specific WS port)
CLIENT_COLLAB_WS_URL=ws://localhost:5001/collaboration

# Client Sentry DSN
CLIENT_SENTRY_DSN=your_client_sentry_dsn


# =============================================================================
# TESTING CONFIGURATION
# =============================================================================

# MailSlurp API key for email testing
MAILSLURP_API_KEY=
